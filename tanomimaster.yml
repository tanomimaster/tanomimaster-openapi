openapi: 3.0.0
info:
  version: 0.1.0-beta
  title: Tanomimaster REST API Specification
  description: Written with Open API Specification 3.
  license:
    name: All Rights Reserved
  contact:
    name: Yuki Matsukura
    url: 'https://tanomimaster.freshdesk.com/support/tickets/new'
    email: support@tanomimaster.freshdesk.com
servers:
  - url: 'https://development.tanomimaster.com/api/v1'
    description: Development
  - url: 'https://staging.tanomimaster.com/api/v1'
    description: Staging
  - url: 'https://tanomimaster.com/api/v1'
    description: Production
paths:
  /retail/products:
    get:
      summary: List products
      operationId: listProducts
      tags:
        - Retail
      parameters:
        - name: limit
          in: query
          description: How many items to return at one time (max 100)
          required: false
          schema:
            type: integer
            format: int32
        - schema:
            type: string
          in: query
          name: maker_code
          description: ''
        - schema:
            type: string
          in: query
          name: product_code
      responses:
        '200':
          description: A paged array of products
          headers:
            X-Total-Pages:
              schema:
                type: integer
            X-Total:
              schema:
                type: integer
            X-Prev-Page:
              schema:
                type: integer
            X-Per-Page:
              schema:
                type: integer
            X-Page:
              schema:
                type: integer
            X-Next-Page:
              schema:
                type: integer
          content:
            application/json:
              schema:
                type: object
                properties:
                  items:
                    type: array
                    items:
                      $ref: '#/components/schemas/Product'
        default:
          description: unexpected error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
      description: list OrderProduct entities
      security:
        - API Key: []
    parameters: []
  '/retail/products/{product_id}':
    get:
      summary: show Product
      operationId: showProductById
      tags:
        - Retail
      parameters:
        - name: product_id
          in: path
          required: true
          description: The id of the product to retrieve
          schema:
            type: string
      responses:
        '200':
          description: Expected response to a valid request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Product'
        default:
          description: unexpected error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
      security:
        - API Key: []
      description: show product by id
    parameters:
      - schema:
          type: integer
          default: 1
          minimum: 1
        name: product_id
        in: path
        description: 商品ID
        required: true
  /retail/orders:
    parameters: []
    get:
      summary: list orders
      tags:
        - Retail
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  items:
                    type: array
                    items:
                      $ref: '#/components/schemas/OrderWithDescendant'
          headers:
            X-Next-Page:
              schema:
                type: integer
            X-Page:
              schema:
                type: integer
            X-Per-Page:
              schema:
                type: integer
            X-Prev-Page:
              schema:
                type: integer
            X-Total:
              schema:
                type: integer
            X-Total-Pages:
              schema:
                type: integer
        default:
          description: unexpected error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
      security:
        - API Key: []
      operationId: listOrders
      description: list orders
    post:
      summary: post order
      operationId: createOrder
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrderWithDescendant'
              examples: {}
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Errors'
              examples: {}
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples: {}
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples: {}
        '409':
          description: Conflict
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples: {}
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples: {}
        default:
          description: unexpected error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
      description: Create an order
      security:
        - API Key: []
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OrderForCreate'
            examples: {}
      tags:
        - Retail
  '/retail/orders/{order_code}':
    parameters:
      - schema:
          type: string
        name: order_code
        in: path
        required: true
    get:
      summary: show an order
      tags:
        - Retail
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrderWithDescendant'
              examples: {}
        default:
          description: unexpected error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
      security:
        - API Key: []
      operationId: showOrderById
      description: show order by Code
  '/retail/orders/{order_code}/order_products':
    parameters:
      - schema:
          type: string
        name: order_code
        in: path
        required: true
    get:
      summary: listOrderProducts
      tags:
        - Retail
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  items:
                    type: array
                    items:
                      $ref: '#/components/schemas/OrderProduct'
          headers:
            X-Next-Page:
              schema:
                type: integer
            X-Page:
              schema:
                type: integer
            X-Per-Page:
              schema:
                type: integer
            X-Prev-Page:
              schema:
                type: integer
            X-Total:
              schema:
                type: integer
            X-Total-Pages:
              schema:
                type: integer
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        default:
          description: unexpected error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
      operationId: get-orders-order_code-products
      description: list OrderProduct entities
      security:
        - API Key: []
    post:
      summary: postOrderProduct
      operationId: post-retail-orders-order_code-order_products
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrderProduct'
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Errors'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
      description: post order_product
      tags:
        - Retail
      security:
        - API Key: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                maker_code:
                  type: string
                code:
                  type: string
                number_of_items:
                  type: integer
                branch_number:
                  type: integer
                shipping_postcode:
                  type: string
                shipping_prefecture_code:
                  type: integer
                shipping_city:
                  type: string
                shipping_street_address:
                  type: string
                shipping_building:
                  type: string
                shipping_office_name:
                  type: string
                shipping_tel:
                  type: string
                gas_type_id:
                  description: ガス種を選択する商品の場合、必須項目
                  oneOf:
                    - type: integer
                    - type: 'null'
                memo:
                  type: string
              required:
                - maker_code
                - code
                - number_of_items
  '/retail/orders/{order_code}/order_products/{branch_number}':
    parameters:
      - schema:
          type: string
        name: order_code
        in: path
        required: true
      - schema:
          type: string
        name: branch_number
        in: path
        required: true
    get:
      summary: showOrderProduct
      tags:
        - Retail
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrderProduct'
        default:
          description: unexpected error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
      operationId: get-orders-order_code-products-order_product_code
      description: show OrderProduct entities corresponding to the id
      security:
        - API Key: []
    post:
      summary: ''
      operationId: post-retail-orders-order_code-order_products-order_product_id
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrderProduct'
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Errors'
              examples:
                リクエストパラメータ不正:
                  value:
                    code: '400'
                    messages:
                      - 注文ステータスの値が不正です
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
      description: 仕入納品または枝番納品キャンセル、枝番注文キャンセルを行う
      security:
        - API Key: []
      parameters: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                order_status:
                  type: string
                  enum:
                    - delivered
                    - undelivered
                    - cancelled
            examples:
              仕入納品:
                value:
                  order_status: delivered
              枝番納品キャンセル:
                value:
                  order_status: undelivered
              枝番注文キャンセル:
                value:
                  order_status: cancelled
        description: ''
      tags:
        - Retail
  /retail/makers:
    get:
      summary: listMakers
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  items:
                    type: array
                    items:
                      $ref: '#/components/schemas/Maker'
          headers:
            X-Next-Page:
              schema:
                type: integer
            X-Page:
              schema:
                type: integer
            X-Per-Page:
              schema:
                type: integer
            X-Prev-Page:
              schema:
                type: integer
            X-Total:
              schema:
                type: integer
            X-Total-Pages:
              schema:
                type: integer
        default:
          description: unexpected error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
      operationId: listMakers
      description: list Maker entities
      security:
        - API Key: []
      tags:
        - Retail
    parameters: []
  '/retail/makers/{maker_id}':
    parameters:
      - schema:
          type: integer
        name: maker_id
        in: path
        required: true
    get:
      summary: showMaker
      tags:
        - Retail
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Maker'
        default:
          description: unexpected error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
      operationId: showMakerById
      parameters: []
      description: Show Maker entity
      security:
        - API Key: []
  /retail/products/check_code:
    post:
      summary: checkProductExistence
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  items:
                    type: array
                    items:
                      $ref: '#/components/schemas/ProductCheckCodeResponse'
              examples:
                normal response. returns availability and price.:
                  value:
                    - maker_code: rinnai
                      products:
                        - code: 12-10002
                          maker_price_for_retail_amount: 10000
                          maker_price_for_retail_currency: JPY
                          is_available: true
                        - code: 12-10003
                          maker_price_for_retail_amount: null
                          maker_price_for_retail_currency: null
                          is_available: true
                    - maker_code: paloma
                      products:
                        - code: '10002'
                          maker_price_for_retail_amount: 10000
                          maker_price_for_retail_currency: JPY
                          is_available: false
                        - code: '10003'
                          maker_price_for_retail_amount: null
                          maker_price_for_retail_currency: null
                          is_available: false
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Errors'
              examples:
                リクエストパラメータ不正:
                  value:
                    code: '400'
                    messages:
                      - 'メーカーが存在しません(<MakerName>)'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        default:
          description: unexpected error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
      operationId: post-products-check
      description: Check the passed ids are existed in this system.
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                items:
                  type: array
                  items:
                    $ref: '#/components/schemas/ProductCheckCodeRequest'
            examples:
              example:
                value:
                  - maker_code: rinnai
                    product_code:
                      - 12-10001
                      - 12-10002
                  - maker_code: noritz
                    product_code:
                      - '190001'
                      - '190002'
        description: ''
      security:
        - API Key: []
      tags:
        - Retail
    parameters: []
  /retail/products/kumo:
    get:
      summary: products data for kumo
      parameters:
        - name: maker_code
          in: query
          required: true
          schema:
            type: string
        - name: from
          in: query
          required: true
          example: 2021/3/30 10:00:00
          description: 時刻の指定が無い場合は0:00:00になります
          schema:
            type: string
        - name: product_code
          in: query
          example: product-1
          schema:
            type: string
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  items:
                    type: array
                    items:
                      $ref: '#/components/schemas/ProductForKumo'
              examples:
                normal response. returns availability and price.:
                  value:
                    - maker_code: RN
                      product_code: 12-10002
                      internal_code: 12-10002
                      name: ｶﾞｽｷｭｳﾄｳｷ002
                      price_amount: 10000
                      maker_price_for_retail_amount: 8000
                      tax_division: 0
                      power_consumption: ""
                      horsepower: ""
                      start_date: 2021/01/20
                      use_gas_type_master: false
                    - maker_code: RN
                      product_code: 12-10003
                      internal_code: 12-10003
                      name: ｶﾞｽｷｭｳﾄｳｷ003
                      price_amount: 30000
                      maker_price_for_retail_amount: 20000
                      tax_division: 0
                      power_consumption: ""
                      horsepower: ""
                      start_date: 2021/01/20
                      use_gas_type_master: true
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Errors'
              examples:
                リクエストパラメータ不正:
                  value:
                    code: '400'
                    messages:
                      - 'メーカーが存在しません(<MakerName>)'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        default:
          description: unexpected error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
      operationId: get-products-kumo
      description: products data format for kumo.
      security:
        - API Key: []
      tags:
        - Retail
    parameters: []
  /categories:
    get:
      summary: listCategories
      tags:
        - Common
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  items:
                    type: array
                    items:
                      $ref: '#/components/schemas/Category'
            application/xml:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Category'
            multipart/form-data:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Category'
          headers:
            X-Next-Page:
              schema:
                type: integer
            X-Page:
              schema:
                type: integer
            X-Per-Page:
              schema:
                type: integer
            X-Prev-Page:
              schema:
                type: integer
            X-Total:
              schema:
                type: integer
            X-Total-Pages:
              schema:
                type: integer
        default:
          description: unexpected error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
      security:
        - API Key: []
      operationId: listCategories
      description: list categories
    parameters: []
  '/categories/{category_id}':
    parameters:
      - schema:
          type: integer
        name: category_id
        in: path
        required: true
    get:
      summary: show the category
      tags:
        - Common
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Category'
        default:
          description: unexpected error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
      operationId: get-category-category_id
      description: show the category
  '/retail/retail_branches/{retail_branch_id}':
    get:
      summary: showRetailBranch
      tags:
        - Retail
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RetailBranch'
        default:
          description: unexpected error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
      operationId: showRetailBranchById
      parameters: []
      description: Show RetailBranch entity
      security:
        - API Key: []
    parameters:
      - schema:
          type: integer
        name: retail_branch_id
        in: path
        required: true
  /retail/retail_branches:
    get:
      summary: listRetailBranches
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  items:
                    type: array
                    items:
                      $ref: '#/components/schemas/RetailBranch'
          headers:
            X-Next-Page:
              schema:
                type: integer
            X-Page:
              schema:
                type: integer
            X-Per-Page:
              schema:
                type: integer
            X-Prev-Page:
              schema:
                type: integer
            X-Total:
              schema:
                type: integer
            X-Total-Pages:
              schema:
                type: integer
        default:
          description: unexpected error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
      operationId: listRetailBranches
      description: list listRetailBranch entities
      security:
        - API Key: []
      tags:
        - Retail
    parameters: []
  /retail/retail_sales_offices:
    get:
      summary: listRetailSalesOffices
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  items:
                    type: array
                    items:
                      $ref: '#/components/schemas/RetailSalesOffice'
          headers:
            X-Next-Page:
              schema:
                type: integer
            X-Page:
              schema:
                type: integer
            X-Per-Page:
              schema:
                type: integer
            X-Prev-Page:
              schema:
                type: integer
            X-Total:
              schema:
                type: integer
            X-Total-Pages:
              schema:
                type: integer
        default:
          description: unexpected error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
      operationId: listRetailSalesOffices
      description: list listRetailSalesOffice entities
      security:
        - API Key: []
      tags:
        - Retail
    parameters: []
  '/retail/retail_sales_offices/{retail_sales_office_id}':
    get:
      summary: showRetailSalesOffice
      tags:
        - Retail
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RetailSalesOffice'
        default:
          description: unexpected error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
      operationId: showRetailSalesOfficeById
      parameters: []
      description: Show RetailSalesOffice entity
      security:
        - API Key: []
    parameters:
      - schema:
          type: integer
        name: retail_sales_office_id
        in: path
        required: true
  /retail/retail_users:
    get:
      summary: listRetailUsers
      tags:
        - Retail
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  items:
                    type: array
                    items:
                      $ref: '#/components/schemas/RetailUser'
      operationId: get-retail-retail_users
      description: list listRetailUser entities
      security:
        - API Key: []
    post:
      summary: bulkCreateRetailUsers
      tags:
        - Retail
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                items:
                  type: array
                  items:
                    type: object
                    properties:
                      user_code:
                        type: string
                      sales_office_code:
                        type: string
                      email:
                        type: string
                      password:
                        type: string
                      last_name:
                        type: string
                      first_name:
                        type: string
                      last_name_kane:
                        type: string
                      first_name_kana:
                        type: string
                      role:
                        type: string
                      tel:
                        type: string
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  items:
                    type: array
                    items:
                      type: object
                      properties:
                        retail_user_code:
                          type: string
                        successful:
                          type: boolean
                        message:
                          type: string
  /retail/retail_users/check_registrations:
    post:
      summary: checkRegisteredRetailUsers
      tags:
        - Retail
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  items:
                    type: array
                    items:
                      type: object
                      properties:
                        retail_user_code:
                          type: string
                        retail_sales_office_code:
                          type: string
                        registed:
                          type: boolean
      operationId: post-retail-retail_users-check_registrations
      description: check registered retail users
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                retail_user_codes:
                  type: array
                  items:
                    type: string
      security:
        - API Key: []
  /retail/orders/batch:
    post:
      summary: Bulk create orders
      operationId: post-retai-orders-batch
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  items:
                    type: array
                    items:
                      oneOf:
                        - $ref: '#/components/schemas/OrderWithDescendant'
                        - type: object
                          properties:
                            error:
                              $ref: '#/components/schemas/Errors'
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  items:
                    type: array
                    items:
                      type: object
                      properties:
                        error:
                          $ref: '#/components/schemas/Errors'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
      description: bulk create orders
      security:
        - API Key: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                items:
                  type: array
                  items:
                    $ref: '#/components/schemas/OrderForCreate'
            examples:
              single product:
                value:
                  items:
                    - code: '2000000014'
                      ordered_at: '2020/03/03 12:43:36'
                      makers:
                        - maker_code: matsukura
                          shipping_postcode: "338-0824"
                          shipping_preferecture_code: "11"
                          shipping_city: "さいたま市桜区"
                          shipping_street_address: "上大久保８８８－５"
                          shipping_building: null
                          shipping_office_name: "日本瓦斯株式会社　浦和営業所"
                          shipping_tel: 048-854-1910
                          retail_user_code: matsukura-sales
                          retail_sales_office_code: '000'
                          desired_delivery_date: 2020/03/20
                          products:
                            - code: '000'
                              branch_number: 2
                              number_of_items: 3
                              gas_type_id: null
                              memo: 備考欄
      tags:
        - Retail
    parameters: []
  /maker/orders:
    parameters: []
    get:
      summary: メーカー用 注文一覧取得API
      tags:
        - Maker
      parameters:
        - name: is_confirmed
          in: query
          description: 受注確定しているかどうか
          required: false
          schema:
            type: boolean
        - name: status
          in: query
          description: ステータス(0：納期未回答, 2：出荷待ち, 3：出荷済み, 4：納品完了, 99：キャンセル)
          required: false
          schema:
            type: integer
        - name: delivery_date_from
          in: query
          description: 納品日FROM(YYYY-MM-DD)
          required: false
          schema:
            type: string
        - name: delivery_date_to
          in: query
          description: 納品日TO(YYYY-MM-DD)
          required: false
          schema:
            type: string
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  items:
                    type: array
                    items:
                      $ref: '#/components/schemas/OrderWithDescendant'
          headers:
            X-Next-Page:
              schema:
                type: integer
            X-Page:
              schema:
                type: integer
            X-Per-Page:
              schema:
                type: integer
            X-Prev-Page:
              schema:
                type: integer
            X-Total:
              schema:
                type: integer
            X-Total-Pages:
              schema:
                type: integer
        default:
          description: unexpected error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
      security:
        - API Key: []
      operationId: listOrdersForMaker
      description: list orders
  /maker/orders/{order_code}:
    parameters:
      - schema:
          type: string
        name: order_code
        in: path
        required: true
    get:
      summary: メーカー用 注文取得API
      tags:
        - Maker
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrdersMakerWithDescendant'
              examples: {}
        default:
          description: unexpected error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
      security:
        - API Key: []
      operationId: showAnOrderForMaker
      description: show an order
  /maker/orders/{order_code}/order_products/{branch_number}/confirm:
    parameters:
      - schema:
          type: string
        name: order_code
        in: path
        required: true
      - schema:
          type: string
        name: branch_number
        in: path
        required: true
    post:
      summary: メーカー用 受注確定API
      operationId: confirm-order
      responses:
        '201':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Order'
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Errors'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
      description: confirm order
      tags:
        - Maker
      security:
        - API Key: []

  /maker/orders/{order_code}/order_products/{branch_number}/delivery_date:
    parameters:
      - schema:
          type: string
        name: order_code
        in: path
        required: true
        description: 注文番号
      - schema:
          type: string
        name: branch_number
        in: path
        required: true
        description: 注文明細No
      - schema:
          type: string
        name: official_estimated_delivery_date
        in: query
        required: true
        description: 納期日(YYYY-MM-DD)
      - schema:
          type: string
        name: retail_code
        in: query
        required: true
        description: 小売コード
    post:
      summary: メーカー用 納期回答API
      operationId: answer-delivery-date
      responses:
        '201':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrderProduct'
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Errors'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
      description: answer delivery date
      tags:
        - Maker
      security:
        - API Key: []
  /maker/orders/{order_code}/order_products/{branch_number}/confirm_cancel:
    parameters:
      - schema:
          type: string
        name: order_code
        in: path
        required: true
        description: 注文番号
      - schema:
          type: string
        name: branch_number
        in: path
        required: true
    post:
      summary: メーカー用 キャンセル受注確定API
      operationId: confirm-cancel-order
      responses:
        '201':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Order'
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Errors'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
      description: confirm order
      tags:
        - Maker
      security:
        - API Key: []

  /status:
    get:
      summary: Your GET endpoint
      tags:
        - Common
      responses:
        '200':
          description: Healthcheck OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  version:
                    type: string
                required:
                  - version
              examples:
                Example:
                  value:
                    version: 1.0.0
        '500':
          description: Healthcheck NG
          content:
            application/json:
              schema:
                type: object
                properties:
                  version:
                    type: string
                required:
                  - version
              examples:
                Example:
                  value:
                    version: 1.0.0
      operationId: get-status
      security:
        - API Key: []
      description: show API version and healthcheck
components:
  schemas:
    Product:
      title: Product
      type: object
      xml:
        name: Product
      x-tags:
        - product
      description: A single product.
      properties:
        id:
          type: integer
          format: int64
        created_at:
          type: string
        updated_at:
          type: string
          format: date-time
        disabled_at:
          type: string
          format: date-time
        estimated_delivery_duration:
          type: integer
        use_gas_type_master:
          type: boolean
        maker_id:
          type: integer
        status:
          type: string
          description: product status in the store
          enum:
            - available
            - pending
            - sold
        internal_code:
          type: string
        name:
          type: string
          example: doggie
        category_id:
          type: integer
        maker_code:
          type: string
      required:
        - id
        - name
        - category_id
    ProductForKumo:
      title: Product for kumo
      type: object
      xml:
        name: Product
      x-tags:
        - product
      description: A single product.
      properties:
        maker_code:
          type: string
          description: 雲の宇宙船内で利用されているメーカーコード
        product_code:
          type: string
          example: 111-222-333-444
          description: 型式（品番）
        internal_code:
          type: string
          description: メーカー内部コード
          example: 12-10002
        name:
          type: string
          description: 商品名
          example: doggie
        price_amount:
          type: integer
          description: メーカー希望小売価格(税抜)
          example: 10000
        maker_price_for_retail_amount:
          type: integer
          description: 仕入れ値
          example: 8000
        tax_division:
          type: integer
          description: '0固定(課税対象)'
          example: 0
        power_consumption:
          type: string
          description: '空文字固定'
          example: ''
        horsepower:
          type: string
          description: '空文字固定'
          example: ''
        start_date:
          type: string
          format: date
          description: 取り扱い開始日
          example: '2021/01/20'
        use_gas_type_master:
          type: boolean
          description: ガス種の指定が必須かどうか
          example: true
      required:
        - maker_code
        - product_code
        - name
        - maker_price_for_retail_amount
        - tax_division
        - power_consumption
        - horsepower
        - start_date
        - use_gas_type_master

    Maker:
      title: Maker
      type: object
      description: A maker
      properties:
        id:
          type: integer
        code:
          type: string
        name:
          type: string
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
      required:
        - id
        - code
        - name
      x-tags:
        - maker
    Category:
      title: Category
      type: object
      x-examples:
        example-1: {}
      x-tags:
        - product
      description: ''
      properties:
        id:
          type: integer
          format: int64
        ancestry_depth:
          type: integer
        ancestry:
          type: string
        updated_at:
          type: string
          format: date-time
        created_at:
          type: string
          format: date-time
        name:
          type: string
        disabled_at:
          type: string
          format: date-time
      required:
        - id
        - name
    Error:
      title: Error
      type: object
      description: A standard error object.
      x-tags:
        - common
      properties:
        code:
          type: string
        message:
          type: string
      required:
        - code
        - message
      x-examples:
        認証失敗:
          code: '401'
          message: 認証に失敗しました
        実行権限がない(e.g. メーカーが本APIを実行した場合など):
          code: '403'
          message: APIを実行する権限がありません
        注文番号重複エラー:
          code: '409'
          message: 注文番号190123456789はすでに存在しています
        注文が見つからない:
          code: '404'
          message: 注文が見つかりませんでした
        サーバエラー:
          code: '500'
          message: 'APIサーバーでエラーが発生しました. <アプリケーションのエラーメッセージ> <発生時刻> <リクエストID>'
    OrderProduct:
      title: OrderProduct
      type: object
      x-tags:
        - order
      description: ''
      properties:
        id:
          type: string
        orders_maker_id:
          type: string
        product_id:
          type: integer
        gas_type_id:
          description: ガス種を選択する商品の場合、必須項目
          oneOf:
            - type: integer
            - type: 'null'
        name:
          type: string
        code:
          type: string
        branch_number:
          type: integer
        internal_code:
          type: string
        price_amount:
          type: integer
        price_currency:
          type: string
        maker_price_for_retail_amount:
          type: integer
        maker_price_for_retail_currency:
          type: string
        subtotal_excluding_tax:
          type: integer
        estimated_delivery_duration:
          type: integer
        shipping_status:
          type: string
          enum:
            - undelivered
            - delivered
        delivery_date:
          type: string
          format: date
        number_of_items:
          type: integer
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
        cancelled_at:
          type: string
          nullable: true
          description: 仕入納品APIでキャンセルした場合、キャンセル日時を設定
          format: date-time
        shipping_postcode:
          type: string
        shipping_prefecture_code:
          type: integer
        shipping_city:
          type: string
        shipping_street_address:
          type: string
        shipping_building:
          type: string
        shipping_office_name:
          type: string
        shipping_tel:
          type: string
        estimated_delivery_date:
          type: string
          format: date
        official_estimated_delivery_date:
          type: string
          format: date
        answered_at:
          type: string
          format: date-time
        order_status:
          type: string
          enum:
            - ordered
            - answered
            - shipped
            - delivered
            - cancelled
        memo:
          type: string
        order_confirmed_at:
          type: string
          format: date-time
        cancel_confirmed_at:
          type: string
          format: date-time
      required:
        - id
        - orders_maker_id
        - product_id
        - name
        - code
        - branch_number
    Order:
      title: Order
      type: object
      description: ''
      x-tags:
        - order
      x-examples:
        example-1: {}
      properties:
        id:
          type: string
        retail_id:
          type: integer
        code:
          type: string
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
        ordered_at:
          type: string
          format: date-time
      required:
        - id
        - retail_id
        - code
    RetailBranch:
      title: RetailBranch
      type: object
      properties:
        id:
          type: string
        code:
          type: string
        name:
          type: string
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
      required:
        - id
        - code
        - name
      x-tags:
        - retail
    RetailSalesOffice:
      title: RetailSalesOffice
      type: object
      properties:
        id:
          type: string
        code:
          type: string
        name:
          type: string
        postcode:
          type: string
        prefecture:
          type: string
        city:
          type: string
        street_address:
          type: string
        tel:
          type: string
        fax:
          type: string
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
      x-tags:
        - retail
    RetailUser:
      title: RetailUser
      type: object
      description: ''
      properties:
        id:
          type: integer
        code:
          type: string
        email:
          type: string
          format: email
        role:
          type: string
          enum:
            - admin
            - clerk
            - sales
        last_name:
          type: string
        first_name:
          type: string
        last_name_kane:
          type: string
        first_name_kana:
          type: string
        tel:
          type: string
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
      x-tags:
        - retail
    Retail:
      title: Retail
      type: object
      properties:
        id:
          type: integer
        name:
          type: string
        code:
          type: string
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
      required:
        - id
        - name
        - code
    OrdersMaker:
      title: OrdersMaker
      x-tags:
        - retail
      type: object
      description: ''
      properties:
        id:
          type: string
        maker_id:
          type: integer
        maker_user_id:
          type: integer
        maker_sales_office_id:
          type: integer
        code:
          type: string
        status:
          type: string
          enum:
            - ordered
            - answered
            - shipped
            - delivered
            - cancelled
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
        retail_sales_office_code:
          type: string
        desired_delivery_date:
          type: string
          format: date
          description: 希望納期. 指定しない場合、タノミマスター算出する納期目安を設定
        retail_user_code:
          type: string
        maker_code:
          type: string
      required:
        - id
        - maker_id
    Errors:
      title: Errors
      type: object
      x-examples: {}
      properties:
        code:
          type: string
        messages:
          type: array
          items:
            type: string
      required:
        - code
        - messages
      description: バリデーションエラーなど複数エラーメッセージがある場合
      x-tags:
        - common
    OrderForCreate:
      title: OrderForCreate
      type: object
      description: ''
      x-tags:
        - order
      x-examples:
        example:
          code: '2000000014'
          ordered_at: '2020/03/03 12:43:36'
          makers:
            - maker_code: '1'
              shipping_postcode: null
              shipping_prefecture_code: 15
              shipping_city: null
              shipping_street_address: 埼玉県さいたま市桜区上大久保８８８－５
              shipping_building: null
              shipping_office_name: 日本瓦斯株式会社　浦和営業所
              shipping_tel: 048-854-1910
              retail_user_code: '01210'
              retail_sales_office_code: '00022'
              desired_delivery_date: 2020/03/10
              products:
                - code: 60S W N300
                  branch_number: 1
                  number_of_items: 3
                  gas_type_id: null
                  memo: 備考欄
      properties:
        code:
          type: string
          pattern: '^[0-9]{10,}$'
          description: 注文番号
        makers:
          type: array
          minItems: 1
          items:
            type: object
            properties:
              maker_code:
                type: string
              products:
                type: array
                minItems: 1
                items:
                  type: object
                  properties:
                    code:
                      type: string
                    branch_number:
                      type: integer
                      description: 明細枝番。指定しない場合、タノミマスターで自動発番
                    number_of_items:
                      type: integer
                      minimum: 1
                    gas_type_id:
                      description: ガス種を選択する商品の場合、必須項目
                      oneOf:
                        - type: integer
                        - type: 'null'
                    memo:
                      type: string
                  required:
                    - code
                    - number_of_items
              code:
                type: string
                description: order code per maker
              retail_sales_office_code:
                type: string
              retail_user_code:
                type: string
              desired_delivery_date:
                type: string
                format: date
                description: 希望納期. 指定しない場合、タノミマスター算出する納期目安を設定
              shipping_postcode:
                type: string
              shipping_city:
                type: string
              shipping_street_address:
                type: string
              shipping_building:
                type: string
              shipping_office_name:
                type: string
              shipping_tel:
                type: string
              shipping_prefecture_code:
                type: integer
            required:
              - maker_code
              - retail_user_code
        ordered_at:
          type: string
          format: date-time
          description: 注文日時。時刻文字列にTZ指定がない場合、JSTとして処理する
    ProductCheckCodeRequest:
      title: ProductCheckCodeRequest
      type: object
      description: POST /products/check_code Request
      properties:
        maker_code:
          type: string
        product_code:
          type: array
          items:
            type: string
      required:
        - maker_code
        - product_code
      x-tags:
        - product
      x-examples:
        example:
          items:
            - maker_code: maker01
              product_code:
                - '111'
                - '222'
            - maker_code: maker02
              product_code:
                - '333'
                - '444'
    ProductCheckCodeResponse:
      title: ProductCheckCodeResponse
      type: object
      x-examples:
        example:
          maker_code: rinnai
          products:
            - code: 12-10002
              maker_price_for_retail_amount: 10000
              maker_price_for_retail_currency: JPY
              is_available: true
            - code: 12-10003
              maker_price_for_retail_amount: null
              maker_price_for_retail_currency: null
              is_available: false
      properties:
        maker_code:
          type: string
        products:
          type: array
          items:
            type: object
            properties:
              code:
                type: string
              maker_price_for_retail_amount:
                oneOf:
                  - type: integer
                  - type: 'null'
                description: ''
              maker_price_for_retail_currency:
                oneOf:
                  - type: string
                  - type: 'null'
              is_available:
                type: boolean
                description: The product is on sale or not
            required:
              - code
      required:
        - maker_code
        - products
      description: POST /products/check_code Response
    OrderWithDescendant:
      allOf:
        - $ref: '#/components/schemas/Order'
        - type: object
          properties:
            orders_makers:
              type: array
              items:
                $ref: '#/components/schemas/OrdersMakerWithDescendant'
      title: OrderWithDescendant
    OrdersMakerWithDescendant:
      allOf:
        - $ref: '#/components/schemas/OrdersMaker'
        - type: object
          properties:
            order_products:
              type: array
              items:
                $ref: '#/components/schemas/OrderProduct'
      title: OrdersMakerWithDescendant
  securitySchemes:
    ApiKeyAuth:
      type: http
      scheme: Bearer
      description: API key acquired on retail management page by admin.
